\chapter{Sklejanie grafów}

Generowanie grafów wysokiego rzędu jest bardzo wymagające zarówno czasowo jak i pamięciowo. Dlatego stosujemy technikę nazywaną sklejaniem grafów. 

\subsection{Dekompozycja problemu}
\begin{definition}
  Niech $F$ jest grafem, $v \in V(F)$, $W \subseteq V(F)$. 
  Funkcja $N_F(v,W)$ będzie zwracać podzbiór wierzchołków $W$, które sąsiadują z $v$: 
  $$N_F(v,W) = \{w \in W | (v,w) \in E(F)\}$$ 
\end{definition}

\begin{definition}
  $F[V(F) - {v}]$ będziemy zapisywać jako $F - v$.
\end{definition}

\begin{theorem}
  Weźmy $x \in V(F)$. Niech podgraf indukowany $G_x = F[N_F(x,V(F))]$
  oraz $H_x = F[V(X) - N_F(x,V(F) - x)]$. Jeśli $F$ jest $R(4,5,25)$ to 
  $G_x$ jest $R(3,5,d)$ a $F_x$ jest $R(4,4,24-d)$.
\end{theorem}


Powyższe twierdzenie jest nieoczywiste, dlatego przeprowadzimy krótki dowód. 


  Niech graf $F$ zawiera przynajmniej jedną klikę $K_3$ oraz przynajmniej jeden zbiór niezależny $N_4$.
  Zauważmy że dla każdej kilki $K_3$ zachodzi jedna z sytuacji:
  \begin{enumerate}
    \item $x \in K3$
    \item $ \exists v \in K_3, (v, x) \in E(F) \land \not \forall u \in K_3, (u,x) \in E(F)$ 
    \item $\not \exists v \in K_3, (v, x) \in E(F)$
  \end{enumerate} 
  
  W przypadku pierwszym klika zostanie rozbita, 2 wierczhołki będą w $G_x$ a $x$ nie będzie w żadnym.
  
  W przypadku drugim wierzchołki tworzące $K_3$, które są połączone z $x$ trafią do $G_x$, niepołączone trafią do $H_x$.
  
  W przypadku trzecim całość $K_3$ trafi do grafu $H_x$, gdzie klika K3 może się pojawić, nie łamiąc R(3,5).

  Z kolei dla każdego zbioru $N_4$ musi zachodzić jedna z sytuacji:
  \begin{enumerate}
    \item $x \in N_4$
    \item $ \exists v \in N_4, (v, x) \in E(F) \land \not \forall u \in N_4, (u,x) \in E(F)$ 
    \item $\not \exists v \in N_4, (v, x) \in E(F)$
  \end{enumerate} 

  W przypadku pierwszym zbiór niezależny zostanie rozbity, 3 wierczhołki będą w $H_x$ a $x$ nie będzie w żadnym.
  
  W przypadku drugim wierzchołki tworzące $N_4$, które są połączone z $x$ trafią do $G_x$, niepołączone trafią do $H_x$.
  
  W przypadku trzecim całość $N_4$ trafi do grafu $G_x$, gdzie zbiór niezależny może się pojawić, nie łamiąc R(4,4).

\subsection{Grafy potrzebne do sklejania}

Korzystając z wiedzy z poprzedniego podrozdziału możemy stwierdzić, że do utworzenia wszystkich grafów R(4,5,24) wystarczy połączenie na wszystkie możliwe sposoby
wszystkich nieizomorficznych grafów R(3,5,d) z wszystkimi nieizomorficznymi grafami R(4,4,24-d). 
Warto zauważyć, że liczby R(3,5) oraz R(4,4) są znane i wynoszą odpowiednio 14 i 18. Oznacza to, że nasze grafy G będą maksymalnie rzędu 13 a grafy H rzędu 17. Co za tym idzie, możemy też wskaząć ograniczenia dolne:
minimalny rząd G to 24-17=7 a minimalny rząd H to 24-13 = 11.  

\subsection{Idea sklejania}
Zbiór danych wymagany do poprawnego sklejania jest uzyskany poprzez wygenerowanie wszystkich nieizomorficznych grafów G rzędów 7-13 spełniających R(3,5), oraz wszystkich nieizomorficznych grafów H rzędów 11-17 spełniających R(4, 4).

Grafy dzielone są na grupy zgodnie z ich rzędem. Dalsze sklejanie przeprowadzone jest na parze grup grafów G i H. Celem sklejania jest uzyskanie grafów rzędu 24 poprzez połączenie grafów G oraz H, a więc suma rzędów grafów G oraz H w grupach branych pod uwagę musi być równa 24. Ze względu na R(3,5) = 14 największy rząd grupy grafów G to 13, a ze względu na R(4,4) = 18 grafy H są ograniczone do 17 wierzchołków. Oznacza to, że istnieje 6 par grup spełniających wymagania.

Potencjalne krawędzie między grafami G oraz H są grupowane w stożki.

\begin{definition}
Prawdopodobny stożek (ang. feasible cone) to podzbiór wszystkich wierzchołków grafu H, który nie tworzy kliki $K_3$\cite{mainpaper}. 
\end{definition}

Podzbiór wierzchołków grafu H o którym jeszcze nie wiemy, czy jest prawdopodobnym stożkiem będziemy  określać mianem stożka.

Dla przeciętnego grafu R(4, 4, 14) znajdziemy około 4000 prawdopodobnych stożków. Jeżeli do każdego z wierzchołków grafu G przypiszemy stożek, uzyskamy takie połączenie grafów G oraz H gdzie każdy wierzchołek grafu G jest sąsiadem wszystkich wierzchołków w przypisanym mu stożku. Główna część algorytmu sklejania polega na eliminacji wszystkich kombinacji stożków, które prowadzą do powstania kilki stopnia 4 lub zbioru niezależnego rzędu 5. Każdy taki zbiór prawdopodobnych stożków jest poprawnym połączeniem grafów G oraz H. Taki algorytm sklejania pozwala uzyskać grafy R(4,5) o różnych rzędach (poprzez inne parowanie grup grafów G i H), ale w tej pracy zajmujemy się jedynie grafami 24-wierzchołkowymi.




\subsection{Algorytm sklejania}
Pierwszym etapem sklejania grafów jest stworzenie dla danego grafu H zbioru prawdopodobnych stożków przed wybraniem grafu G do sklejenia. Należy odrzucić wszystkie stożki które obejmują klikę trzeciego rzędu. Takie stożki eliminują wszystkie grafy wynikowe ponieważ połączenie kliki trzeciego rzędu z dowolnym wierzchołkiem powoduje wystąpienie kliki czwartego rzędu. Podejście naiwne, czyli pojedyncze sprawdzenie wszystkich potencjalnie prawdopodobnych stożków nie jest jednak opłacalne ze względu na że ilość stożków dla grafu n wierzchołkowego, która jest równa $2^n$. W celu przyspieszenia obliczeń stożki grupowane są w przedziały. 

\begin{definition}
Przedział $[B, T]$ to zbiór stożków, ograniczony przez stożek górny T i stożek dolny B, który zawiera wszystkie stożki spełniające zależność:  $$X: B \subseteq X \subseteq T$$ 
\end{definition}


Znajdowanie prawdopodobnych stożków rozpoczynamy od pojedynczego przedziału gdzie $B = \emptyset$, a T zawiera wszystkie wierzchołki H. Taki przedział zawiera wszystkie możliwe stożki. W celu wyodrębnienia prawdopodobnych stożków korzystamy z poniższych własności:
\begin{enumerate}
\item Dla wierzchołka $w$, który spełnia $w \notin B$ oraz $w\in T$ prawdą jest, że $[B, T] = [B + \{ w\}, T] \cup [B , T - \{ w\}]$ oraz $[B +\{ w\}, T] \cap [B , T - \{ w\}] = \emptyset$

\item Jeżeli stożek $B$ zawiera klikę stopnia 3, to wszystkie stożki w przedziale również ją zawierają. 

\item Jeżeli stożek $T$ nie zawiera kliki stopnia 3, to wszystkie stożki w przedziale jej nie zawierają.
\end{enumerate}

Korzystając z własności 2 i 3 jako warunku odpowiednio odrzucenia lub zaakceptowania przedziału można skorzystać z algorytmu rekurencyjnego dzielącego interwały wzdłuż wierzchołków należących do kliki 3 oraz stożka B, dzięki czemu uzyskujemy zbiór przedziałów dla grafu H zawierający jedynie stożki prawdopodobne. Z tego zbioru korzystamy w następnym etapie algorytmu.
Dalsze odrzucanie stożków musi odbyć się już w kontekście grafu G.
  

\subsection{Zawężanie przedziałów - zasady A-D}
Zdefiniujmy 3 funkcje pomocnicze działające na podzbiorze wierzchołków grafu $H$ oznaczonym jako $X$, generujące podzbiór wierzchołków grafu $H$. 
Funkcja $H_1$ będzie wybierała wszystkich sąsiadów wierzchołków ze zbioru $X$.
$H_2$ wybiera wszystkie wierzchołki, które nie sąsiadują z jednym lub większą ilością wierzchołków spoza X. 
$H_3$ wybiera wszystkie wieszchołki, które tworzą zbiór niezależny o stopniu 3 z dwoma wierzchołkami spoza zbioru X.

$$H_i: X \subseteq V(G) \to Y \subseteq V(G)$$

\begin{itemize}
    
  \item   $H_1(X) \to X = { w \in V(H) | vw \in E(X) \textrm{ dla jakiegoś } v \in X }$ 
  
  \item   $H_2(X) \to X = { w \in V(H) | vw \notin E(X) \textrm{ dla jakiegoś } v \notin X}$
  
  \item   $H_3(X) \to X = { w \in V(H) | { u, v, w } \textrm{ jest zbiorem niezależnym dla jakichś } v, u \notin X}$ 
\end{itemize}


Rozpatrzmy podany graf, rysunek \ref{zasada0}. Dla tego grafu zostanie zaprezentowanie działanie zasad  $H_1$,  $H_2$ oraz  $H_3$. Na rysunkach \ref{zasada1}, \ref{zasada2}, \ref{zasada2}, przedctawiony jest sposób działania tych funkcji. Pierwszy graf, jest grafem który jest przekazywany do funkcji, a wieszchołki zaznaczone na niebiesko oznaczają wieszchołki ze zbioru $X$. Drugi graf zawiera wieszchołki zaznaczone na czerwono, jest to ten podzbiów wieszchołków które funkcja zwraca.


 \begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main] (3) at (0:2) {$3$};
 \node[main] (2) at (60:2) {$2$};
 \node[main] (1) at (120:2) {$1$};
 \node[main] (6) at (180:2) {$6$};
 \node[main] (5) at (240:2) {$5$};
 \node[main] (4) at (300:2) {$4$};

\draw[ultra thick] (1) -- (2);
\draw[ultra thick] (1) -- (3);
\draw[ultra thick] (1) -- (6);
\draw[ultra thick] (1) -- (5);
\draw[ultra thick] (6) -- (5);
\draw[ultra thick] (2) -- (4);
\draw[ultra thick] (3) -- (4);
    \end{tikzpicture}
    \caption{}
 \label{zasada0}
 \end{figure}

Funkcja $H_1$ znajduje wszystkich sąsiadów wieszchołków ze zbioru wejściowego. W podanym przykładdzie na rysunku \ref{zasada1} oznacza to że musimy znaleść sąsiadów wieszchołków ze zbioru \{3, 4\}. Łatwo zauważyć że wieszchołki z nimi sąsiadujące to zbiór wieszchołków \{1, 2, 3, 4\}.

 \begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][blue]  (3) at (0:2) {$3$};
 \node[main] (2) at (60:2) {$2$};
 \node[main] (1) at (120:2) {$1$};
 \node[main] (6) at (180:2) {$6$};
 \node[main] (5) at (240:2) {$5$};
 \node[main][blue]  (4) at (300:2) {$4$};

\draw[ultra thick] (1) -- (2);
\draw[ultra thick] (1) -- (3);
\draw[ultra thick] (1) -- (6);
\draw[ultra thick] (1) -- (5);
\draw[ultra thick] (6) -- (5);
\draw[ultra thick] (2) -- (4);
\draw[ultra thick] (3) -- (4);
    \end{tikzpicture}
    \hspace{15mm}
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][red] (3) at (0:2) {$3$};
 \node[main][red] (2) at (60:2) {$2$};
 \node[main][red] (1) at (120:2) {$1$};
 \node[main] (6) at (180:2) {$6$};
 \node[main] (5) at (240:2) {$5$};
 \node[main][red] (4) at (300:2) {$4$};

\draw[ultra thick] (1) -- (2);
\draw[ultra thick] (1) -- (3);
\draw[ultra thick] (1) -- (6);
\draw[ultra thick] (1) -- (5);
\draw[ultra thick] (6) -- (5);
\draw[ultra thick] (2) -- (4);
\draw[ultra thick] (3) -- (4);
    \end{tikzpicture}
    \caption{}
 \label{zasada1}
 \end{figure}

Funkcja $H_2$ znajduje wszystkie wieszchołki, które nie sąsiadują z co najmniej jednym wieszchołkiem z poza zbioru wejściowego. W podanym przykładdzie na rysunku \ref{zasada2} oznacza to że musimy znaleść wieszchołki które nie sąsiadują ze wszystkimi wieszchołkami ze zbioru (wykluczając wieszchołek który aktualnie rozpatrujemy, jeżeli jest w zbiorze) \{1, 2, 5, 6\}. Łatwo zauważyć że jedymym wieszchołkiem który sąsiaduje ze wszystkimi wieszchołkami z tego zbioru jest wieszchołek o numerze 1, więc zbiór wyjściowy będzie wyglądac następująco \{2, 3, 4, 5, 6\}.

 \begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][blue]  (3) at (0:2) {$3$};
 \node[main] (2) at (60:2) {$2$};
 \node[main] (1) at (120:2) {$1$};
 \node[main] (6) at (180:2) {$6$};
 \node[main] (5) at (240:2) {$5$};
 \node[main][blue]  (4) at (300:2) {$4$};

\draw[ultra thick] (1) -- (2);
\draw[ultra thick] (1) -- (3);
\draw[ultra thick] (1) -- (6);
\draw[ultra thick] (1) -- (5);
\draw[ultra thick] (6) -- (5);
\draw[ultra thick] (2) -- (4);
\draw[ultra thick] (3) -- (4);
    \end{tikzpicture}
    \hspace{15mm}
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][red] (3) at (0:2) {$3$};
 \node[main][red] (2) at (60:2) {$2$};
 \node[main] (1) at (120:2) {$1$};
 \node[main][red] (6) at (180:2) {$6$};
 \node[main][red] (5) at (240:2) {$5$};
 \node[main][red] (4) at (300:2) {$4$};

\draw[ultra thick] (1) -- (2);
\draw[ultra thick] (1) -- (3);
\draw[ultra thick] (1) -- (6);
\draw[ultra thick] (1) -- (5);
\draw[ultra thick] (6) -- (5);
\draw[ultra thick] (2) -- (4);
\draw[ultra thick] (3) -- (4);
    \end{tikzpicture}
    \caption{}
 \label{zasada2}
 \end{figure}

Funkcja $H_3$ znajduje wszystkie wieszchołki, które tworzą zbiór niezależny o stopniu 3 z dwoma wierzchołkami spoza zbioru X. W podanym przykładzie na rysunku \ref{zasada3} oznacza top że musimy znaleść wieszchołki które tworza zbiór niezależny wraz z dwoma wieszchołkami ze zbioru \{1, 2, 5, 6\}. Łatwo zauważyć że jedynym wieszchołkiem który spełnia to założenie jest wieszchiłek oznaczony numerem 3, gdyż tworzy on zbiór niezależny stopnia 3 wraz z wieszchołkami o numerach 2 oraz 5.

 \begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][blue]  (3) at (0:2) {$3$};
 \node[main] (2) at (60:2) {$2$};
 \node[main] (1) at (120:2) {$1$};
 \node[main] (6) at (180:2) {$6$};
 \node[main] (5) at (240:2) {$5$};
 \node[main][blue]  (4) at (300:2) {$4$};

\draw[ultra thick] (1) -- (2);
\draw[ultra thick] (1) -- (3);
\draw[ultra thick] (1) -- (6);
\draw[ultra thick] (1) -- (5);
\draw[ultra thick] (6) -- (5);
\draw[ultra thick] (2) -- (4);
\draw[ultra thick] (3) -- (4);
    \end{tikzpicture}
    \hspace{15mm}
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][red] (3) at (0:2) {$3$};
 \node[main] (2) at (60:2) {$2$};
 \node[main] (1) at (120:2) {$1$};
 \node[main] (6) at (180:2) {$6$};
 \node[main] (5) at (240:2) {$5$};
 \node[main] (4) at (300:2) {$4$};

\draw[ultra thick] (1) -- (2);
\draw[ultra thick] (1) -- (3);
\draw[ultra thick] (1) -- (6);
\draw[ultra thick] (1) -- (5);
\draw[ultra thick] (6) -- (5);
\draw[ultra thick] (2) -- (4);
\draw[ultra thick] (3) -- (4);
    \end{tikzpicture}
    \caption{}
 \label{zasada3}
 \end{figure}


Kolejny etap zawężania zbioru potencjalnych krawędzi pomiędzy grafami $G$ oraz $H$ odbywa się już w kontekście konkretnego grafu $G$. Każda możliwa kombinacja wygenerowanych przedziałów jest  przydzielana do wierzchołków należących do $G$, dzięki czemu rozważone są wszystkie możliwe sposoby połączenia tych grafów. Dla każdego zbioru przedziałów łączących grafy $G$ oraz $H$ wykonywany jest poniższy zbiór reguł działających na wierzchołki i przedziały stożków im przypisane:
\begin{itemize}
  \item[A] - stosowana do 2 wierzchołków $u,v$ $\in G$ sąsiadujących ze sobą 
  
  Jeśli $B_u \cap B_v \cap H_1(B_u \cap B_v) \neq \emptyset $ to nie da się 
  poprawnie skleić tej pary grafów. 
  
  W innym wypadku z $T_u$ usuwamy $H_1(B_u \cap B_v) \cap B_v $  
  \item[B] - stosowana do 2 wierzchołków $u,v$ $\in G$ nie sąsiadujących ze sobą 
  
  Jeśli $H_3(T_u \cup T_v) \not\subseteq (T_u \cup T_v)$ to nie da się poprawnie skleić tej 
  pary grafów. 
  
  W innym wypadku $B_u$ rozszerzamy do $B_u \cup (H_3(T_u \cup T_v) - T_v)$
  \item[C] - stosowana do 3 wierzchołków $u,v,w$ $\in G$ tworzących zbiór niezależny $N_3$ 
  
  Jeśli $H_2(T_u \cup T_v \cup T_w) \not\subseteq (T_u \cup T_v \cup T_w)$ 
  to nie da się poprawnie skleić tej pary grafów. 
  
  W innym wypadku $B_u$ rozszerzamy do $B_u \cup (H_2(T_u \cup T_v \cup T_w) - (T_v \cup T_w))$
  \item[D] - stosowana do 4 wierzchołków $u,v,w,z$ $\in G$ tworzących zbiór niezależny $N_4$  
  
  Jeśli $T_u \cup T_v \cup T_w \cup \neq VH $ to nie da się poprawnie skleić tej pary grafów.
  
  W innym wypadku $B_u$ rozszerzamy do $B_u \cup (VH - (T_v \cup T_w \cup T_z))$
\end{itemize}

Zasada A sprawdza czy sąsiednie wierzchołki $u, v$ mają jakąkolwiek parę wspólnych potencjalnych sąsiadów, którzy są sąsiedni względem siebie.
W takiej sytuacji powstałaby klika $K_4$, więc nie uda się utworzyć grafu. \par

Przyjrzyjmy się rysunkowi \ref{zasadaA1}. Czerowne wierchołki to $u, v$ z grafu G, 
a czerwone, przerywane krawędzie reprezentują dolne ograniczenia przypisanych im stożków.
Jak widać, $u i v$ muszą zostać połączone z parą sąsiadujących wierzchołków 1 i 2, więc nie 
da się połączyć grafów użyciem takiego przypisania stożków. 
\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (60:2) {$2$};
    \node[main][blue] (3) at (120:2) {$3$};
    \node[main][blue] (4) at (180:2) {$4$};
    \node[main][blue] (5) at (240:2) {$5$};
    \node[main][blue] (6) at (300:2) {$6$};

    \draw (1) -- (2);
    \draw (1) -- (3);
    \draw (6) -- (1);
    \draw (6) -- (2);
    \draw (6) -- (3);
    \draw (6) -- (4);
    \draw (6) -- (5);

    \vspace{10mm};

    \node[main][red] (7) [below left of=5] {$u$};
    \node[main][red] (8) [below right of=6] {$v$};

    \draw (7) -- (8);

    \draw [ultra thick][red, dashed] (7) -- (3);
    \draw [ultra thick][red, dashed] (7) -- (1);
    \draw [ultra thick][red, dashed] (7) -- (2);

    \draw [ultra thick][red, dashed] (8) -- (1);
    \draw [ultra thick][red, dashed] (8) -- (2);

\end{tikzpicture}
 \caption{}
 \label{zasadaA1}
 \end{figure}

 Jeżeli powyższa sytuacja nie zajdzie, musimy usunąć z $T_u$ niezbędnych sąsiadów $v$, 
 którzy sąsiadują z przynajmniej jednym z niezbędnych sąsiadów $u$. 
 
  Na rysunku \ref{zasadaA2} wprowadzono ograniczenie górne, reprezentowane niebieskimi, 
  przerywanymi krawędziami.  Jak widać, to połączenie nie jest odrzucane (istnieje możliwość połączenie bez utworzenia $K_4$).
    
  Trzeba więc odrzucić potencjalne połączenia pomiędzy $v$ a niezbędnymi sąsiadami $u$. 
  Na przykładowym rysunku będzie to oznaczało usunięcie krawędzi $(u, 5)$. Zgodnie z zasadą A nie usuwamy jeszcze krawędzi 
  $(v,2)$ - zostanie ona usunięta kiedy to $v$ będzie pełniła rolę $v$ w funkcji.  

 \begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (60:2) {$2$};
    \node[main][blue] (3) at (120:2) {$3$};
    \node[main][blue] (4) at (180:2) {$4$};
    \node[main][blue] (5) at (240:2) {$5$};
    \node[main][blue] (6) at (300:2) {$6$};

    \draw (1) -- (2);
    \draw (1) -- (3);
    \draw (6) -- (1);
    \draw (6) -- (2);
    \draw (6) -- (3);
    \draw (6) -- (4);
    \draw (6) -- (5);

    \vspace{20mm};

    \node[main][red] (7) [below left of=5] {$u$};
    \node[main][red] (8) [below right of=6] {$v$};

    \draw (7) -- (8);

    \draw [ultra thick][red, dashed] (7) -- (3);
    \draw [ultra thick][red, dashed] (7) -- (1);
    \draw [ultra thick][blue, dashed] (7) -- (5);

    \draw [ultra thick][red, dashed] (8) -- (1);
    \draw [ultra thick][red, dashed] (8) -- (5);
    \draw [ultra thick][blue, dashed] (8) -- (2);

\end{tikzpicture}
 \caption{}
 \label{zasadaA2}
 \end{figure}

Zasada B sprawdza czy istnieją w grafie H zbiory niezależne $N_3$, z których wierzchołkami żaden z wierzchołków $u, v $ nie może zostać połączony. W takim wypadku nie da się skleić grafów bez utworzenia zbioru niezależnego $N_5$. 

Dla przykładu, przeanalizujmy rysunek \ref{zasadaB1}. Wierzchołki 2, 4, 6 tworzą zbiór niezależny i żaden z nich nie mieści się w ograniczeniach gównych wierczhołków 
$u, v$. W związku z tym, dana próba połączenia nie zakończy się sukcesem. 

\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (60:2) {$2$};
    \node[main][blue] (3) at (120:2) {$3$};
    \node[main][blue] (4) at (180:2) {$4$};
    \node[main][blue] (5) at (240:2) {$5$};
    \node[main][blue] (6) at (300:2) {$6$};

    \draw (3) -- (1);
    \draw (6) -- (1);
    \draw (6) -- (3);
    \draw (6) -- (5);
    \draw (5) -- (1);
    \draw (4) -- (3);

    \vspace{20mm};

    \node[main][red] (7) [below left of=5] {$u$};
    \node[main][red] (8) [below right of=6] {$v$};

    \draw [ultra thick][blue, dashed] (7) -- (3);
    \draw [ultra thick][blue, dashed] (7) -- (1);
    \draw [ultra thick][blue, dashed] (7) -- (5);

    \draw [ultra thick][blue, dashed] (8) -- (1);
    \draw [ultra thick][blue, dashed] (8) -- (5);

\end{tikzpicture}
 \caption{}
 \label{zasadaB1}
 \end{figure}

Jeżeli powyższa sytuacja nie zachodzi, musimy do zbioru $B_u$ dodać wszystkie wierzchołki, 
z którymi przynajmniej 2 wierzchołki spoza zbioru $T_u \cup T_v$ nie sąsiadują. Wyjątkiem są te, z którymi można połączyć $v$. \par

W przykładzie z rysunku \ref{zasadaB2} trzeba dodać wierchołek 4 do dolnego ograniczenia $u$.
\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (60:2) {$2$};
    \node[main][blue] (3) at (120:2) {$3$};
    \node[main][blue] (4) at (180:2) {$4$};
    \node[main][blue] (5) at (240:2) {$5$};
    \node[main][blue] (6) at (300:2) {$6$};

    \draw (3) -- (1);
    \draw (6) -- (1);
    \draw (6) -- (3);
    \draw (6) -- (5);
    \draw (5) -- (1);
    \draw (4) -- (3);
    \draw (2) -- (3);

    \vspace{20mm};

    \node[main][red] (7) [below left of=5] {$u$};
    \node[main][red] (8) [below right of=6] {$v$};

    \draw [ultra thick][red, dashed] (8) -- (3);
    \draw [ultra thick][red, dashed] (8) -- (1);
    \draw [ultra thick][blue, dashed] (8) -- (5);

    \draw [ultra thick][blue, dashed] (7) -- (1);
    \draw [ultra thick][blue, dashed] (7) -- (4);
    \draw [ultra thick][red, dashed] (7) -- (5);

\end{tikzpicture}
 \caption{}
 \label{zasadaB2}
 \end{figure}

Zasada C sprawdza czy istnieją w grafie H dwa niesąsiadujące wierzchołki, z którymi żaden z wierzchołków zbioru niezależnego $u, v, w$ nie może zostać połączony. 
Oznaczałoby to, że musi powstać zbiór niezależny $N_5$, a grafów nie można skleić.

W przykładzie z rysunku \ref{zasadaC1} musi powstać zbiór niezależny $N_5$, ponieważ żaden z wierzchołków $u, v, w$ nie może zostać połączony z którymś z niesąsiadujących 
wierzchołków 2, 4. Ten sposób połączenia zostanie więc odrzucony. 

\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (60:2) {$2$};
    \node[main][blue] (3) at (120:2) {$3$};
    \node[main][blue] (4) at (180:2) {$4$};
    \node[main][blue] (5) at (240:2) {$5$};
    \node[main][blue] (6) at (300:2) {$6$};

    \draw (6) -- (1);
    \draw (6) -- (2);
    \draw (6) -- (3);
    \draw (6) -- (4);
    \draw (6) -- (5);
    \draw (4) -- (5);

    \vspace{20mm};

    \node[main][red] (7) [below left of=5] {$u$};
    \node[main][red] (8) [below right of=6] {$v$};
    \node[main][red] (9) [right of=8] {$w$};

    \draw [ultra thick][blue, dashed] (7) -- (3);
    \draw [ultra thick][blue, dashed] (7) -- (1);
    \draw [ultra thick][blue, dashed] (7) -- (5);

    \draw [ultra thick][blue, dashed] (8) -- (1);
    \draw [ultra thick][blue, dashed] (8) -- (5);

    \draw [ultra thick][blue, dashed] (9) -- (1);

\end{tikzpicture}
 \caption{}
 \label{zasadaC1}
 \end{figure}

W innym wypadku do $B_u$ trzeba dodać wierzchołki które nie sąsiadują z wierzchołkiem, 
z którym żaden z wierzchołków $u, v, w$ nie może zostać połączony, z wyjątkiem tych z którymi może sąsiadować $v$ lub $w$.  \par

Dla sytaucji z rysunku \ref{zasadaC2} konieczne jest dodanie do dolnego ograniczenia dla $u$ wierzchołka 4. 
\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (60:2) {$2$};
    \node[main][blue] (3) at (120:2) {$3$};
    \node[main][blue] (4) at (180:2) {$4$};
    \node[main][blue] (5) at (240:2) {$5$};
    \node[main][blue] (6) at (300:2) {$6$};

    \draw (6) -- (1);
    \draw (6) -- (2);
    \draw (6) -- (3);
    \draw (6) -- (4);
    \draw (6) -- (5);
    \draw (4) -- (5);

    \vspace{20mm};

    \node[main][red] (7) [below left of=5] {$u$};
    \node[main][red] (8) [below right of=6] {$v$};
    \node[main][red] (9) [right of=8] {$w$};

    \draw [ultra thick][red, dashed] (7) -- (3);
    \draw [ultra thick][blue, dashed] (7) -- (1);
    \draw [ultra thick][blue, dashed] (7) -- (5);
    \draw [ultra thick][blue, dashed] (7) -- (4);

    \draw [ultra thick][blue, dashed] (8) -- (1);
    \draw [ultra thick][blue, dashed] (8) -- (5);

    \draw [ultra thick][blue, dashed] (9) -- (1);

\end{tikzpicture}
 \caption{}
 \label{zasadaC2}
 \end{figure}

Zasada D sprawdza czy graf H zawiera wierzchołek, z którym żaden z niesąsiadujących wierzchołków $u, v, w, z$
nie może sąsiadować. Ponownie, w takim przypadku powstałby zbiór niezależny $N_5$.

Na rysunku \ref{zasadaD1} żaden z wierchołków $v, z, w, u$ nie może zostać połączony z wierzchołkiem 6. Ten sposób połączenia należy odrzucić. 
\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (60:2) {$2$};
    \node[main][blue] (3) at (120:2) {$3$};
    \node[main][blue] (4) at (180:2) {$4$};
    \node[main][blue] (5) at (240:2) {$5$};
    \node[main][blue] (6) at (300:2) {$6$};

    \draw (6) -- (1);
    \draw (6) -- (2);
    \draw (6) -- (3);
    \draw (3) -- (4);
    \draw (4) -- (5);
    \draw (5) -- (3);
    \draw (3) -- (2);
    \draw (4) -- (1);

    \vspace{20mm};

    
    \node[main][red] (8) [below right of=6] {$u$};
    \node[main][red] (9) [below left of=5] {$v$};
    \node[main][red] (7) [left of=8] {$w$};
    \node[main][red] (10) [right of=9] {$z$};

    \draw [ultra thick][blue, dashed] (7) -- (2);
    \draw [ultra thick][blue, dashed] (8) -- (4);
    \draw [ultra thick][blue, dashed] (9) -- (5);
    \draw [ultra thick][blue, dashed] (10) -- (3);
    \draw [ultra thick][blue, dashed] (8) -- (1);
  

\end{tikzpicture}
 \caption{}
 \label{zasadaD1}
 \end{figure}

Jeżeli powyższe nie zajdzie, musimy dodać do $B_u$ wszystkie wierzchołki, z którymi v, w, z nie mogą sąsiadować. \par

Przykładowo, na rysunku \ref{zasadaD2} $u$ jest połączone ze wszystkimi wierzchołkami 1-5, ale 1 i 2 mogą też zostać połączone z innymi wierzchołkami, więc do
$B_u$ zostanie dodany tylko wierzchołek 3.   
\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
    
    \node[main][blue] (1) at (0:2) {$1$};
    \node[main][blue] (2) at (90:2) {$2$};
    \node[main][blue] (3) at (180:2) {$3$};
    \node[main][blue] (4) at (270:2) {$4$};


    \draw (3) -- (4);
    \draw (3) -- (2);
    \draw (4) -- (1);

    \vspace{20mm};

    
    \node[main][red] (8) [below right of=4] {$w$};
    \node[main][red] (9) [below left of=4] {$v$};
    \node[main][red] (7) [left of=9] {$u$};
    \node[main][red] (10) [right of=8] {$z$};

    \draw [ultra thick][blue, dashed] (7) -- (3);
    \draw [ultra thick][blue, dashed] (7) -- (2);
    \draw [ultra thick][blue, dashed] (7) -- (1);
    \draw [ultra thick][blue, dashed] (9) -- (2);
    \draw [ultra thick][blue, dashed] (10) -- (1);
    \draw [ultra thick][blue, dashed] (10) -- (4);

  

\end{tikzpicture}
 \caption{}
 \label{zasadaD2}
 \end{figure}

Warto zauważyć, że wynikiem zastosowania dowolnej reguły jest zawsze odrzucenie zestawu przedziałów, zawężenie przedziału lub brak zmian. Reguły są więc aplikowane do momentu, w którym ponowne zaaplikowanie dowolnej reguły dla dowolnych wierzchołków nie powoduje już dalszych zmian. Wynikowy zbiór przedziałów daje sposób lub sposoby połączenia grafów G oraz H w graf 24 wierzchołkowy z spełniający wymagania pod względem ramseyowskości.


\subsection{Wynik sklejania}

Po zakończeniu procesu sklejania uzyskujemy zbiór grafów R(4,5,24). W dalszej części pracy graf z tego zbioru będzie oznaczany jako graf $\mathcal{F}$. Jeżeli zbiór R(4,5,25) $\neq \emptyset$ to w wyniku rozszerzenia przynajmniej jednego z grafów $\mathcal{F}$ o jeden wierzchołek powinniśmy uzyskać przynajmniej jeden graf 25 wierzchołkowy spełniający wymagania. 
Rozszerzanie o jeden wierzchołek zostaje w tym wypadku wykonane metodą podobną do wcześniejszego tworzenia przedziałów stożków, choć w tym wypadku mamy tylko jeden wierzchołek, do którego przypisywane są stożki rozszerzające.
\begin{definition} Stożek rozszerzający to podzbiór wierzchołków grafu $\mathcal{F}$ symbolizujący możliwe połączenia pomiędzy grafem $\mathcal{F}$ a wierzchołkiem do niego dodawanym.
\end{definition}

Po raz kolejny, wszystkie możliwe stożki rozszerzające są grupowane w przedział, który w trakcie działania algorytmu jest zawężany. Przedziały stożków rozszerzających mają te same własności, co przedziały stożków prawdopodobnych, w tym wypadku mają jednak znaczenie dwie dodatkowe własności:

\begin{enumerate}
\item Dla wierzchołka $w$, który spełnia $w \notin B$ oraz $w\in T$ prawdą jest, że $[B, T] = [B + \{ w\}, T] \cup [B , T - \{ w\}]$ oraz $[B +\{ w\}, T] \cap [B , T - \{ w\}] = \emptyset$

\item Jeżeli stożek $B$ zawiera klikę stopnia 3, to wszystkie stożki w przedziale również ją zawierają. 

\item Jeżeli stożek $T$ nie zawiera kliki stopnia 3, wszystkie stożki w przedziale jej nie zawierają.

																													  
				 
\item Jeżeli zbiór $B$ zawiera przynajmniej jeden wierzchołek ze zbioru niezależnego stopnia 4, to wszystkie zbiory w przedziale również go zawierają. 

\item Jeżeli zbiór $T$ nie zawiera żadnego wierzchołka ze zbioru niezależnego stopnia 4, wszystkie stożki w przedziale ich nie zawierają.
\end {enumerate}



Etapem przygotowawczym do rozszerzania jest stworzenie listy podzbiorów wierzchołków $\mathcal{F}$ które tworzą kliki lub zbiory niezależne. Takie podzbiory nazywamy dalej strukturami.
\begin{definition} Struktura to podzbiór wierzchołków grafu $\mathcal{F}$ który nakłada ograniczenia na sposoby rozszerzenia go o wierzchołek.
\end{definition}
Celem powstania listy struktur jest przyspieszenie znajdywania stożków rozszerzających, które prowadzą do zaburzenia ramseyowskości grafu wynikowego. Jeżeli nowy wierzchołek zostałby połączony ze wszystkimi wierzchołkami $K_3$, to powstające $K_4$ dyskwalifikuje graf. Podobna sytuacja występuje w przypadku braku połączenia do któregokolwiek z wierzchołków $N_4$ gdzie w wyniku otrzymujemy niedozwolone $N_5$. 
Mając listę wszystkich struktur, można przystąpić do zawężania przedziału stożków rozszerzających. Rozpoczynamy ponownie od przedziału $[B = \emptyset, T = \{V(F)\} ]$ który obejmuje wszystkie możliwe stożki dla grafu $\mathcal{F}$, a więc również wszystkie możliwe rozszerzenia. Dla każdej struktury $S$, których listę utworzyliśmy wcześniej dokonujemy porównania przedziałów. Porównywanie odbywa się w następujące sposoby, zależne od tego, czy obecnie rozważana struktura opisuję klikę, czy zbiór niezależny.

Rozumowanie dla ograniczenia wynikającego z kliki przebiega następująco:
\begin{algorithm}[H]
  \caption{Porównanie przedziału $P$ do struktury $S$ opisującej klikę}
  \begin{algorithmic}
  \IF{$S \subseteq T_P$}
	\IF{$S\subseteq B_P $} 
	  \STATE Usuń $P$ z listy przedziałów
	\ELSE
	  \STATE Podziel przedział $P$ wzdłuż $S \setminus B_P  $
  	\ENDIF
  \ENDIF  
  \end{algorithmic}
\end{algorithm}

Rozumowanie dla ograniczenia wynikającego ze zbioru niezależnego przebiega z kluczowymi różnicami w warunkach oraz sposobie podziału:

\begin{algorithm}[H]
  \caption{Porównanie przedziału $P$ do struktury $S$ opisującej zbiór niezależny}
  \begin{algorithmic}
  \IF{$S \not\subseteq B_P$}
	\IF{$S\not\subseteq T_P $} 
	  \STATE Usuń $P$ z listy przedziałów
	\ELSE
	  \STATE Podziel przedział $P$ wzdłuż $S \cap T_P  $
  	\ENDIF
  \ENDIF  
  \end{algorithmic}
\end{algorithm}

W powyższych algorytmach zostaje użyte pojęcie podziału przedziałów. Podział przedziału polega na  użyciu własności 1 dla podanego zbioru wierzchołków w celu wielokrotnego rozdzielenia przedziału na dwie części a następnie odrzucenia tego z nich, który zawiera wszystkie stożki łączące sprawdzaną strukturę w niepoprawny sposób. Pozostałe przedziały wynikowe są dodawane do listy przedziałów do sprawdzenia, ponieważ nie łamią obecnie analizowanego ograniczenia. 

Dla przykładu załóżmy, że dla grafu $G$, który próbujemy rozszerzyć o wierzchołek $v$ na rysunku poniżej przekształcamy przedział $P =[\{5\},\{1,2,3,4,5\}]$ przy pomocy kliki $S = \{1,2,3\}$.
\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][red] (1) at (1*90:1) {$1$};
 \node[main][red] (2) at (2*0:1.5) {$2$};
 \node[main] (5) at (3*60:1.5) {$5$};
 \node[main] (4) at (4*60:2) {$4$};
 \node[main][red] (3) at (5*60:2) {$3$};
 \node[main] (v) at (6*180:5) {$v$};

\draw[ultra thick][red] (1) -- (2);
\draw[ultra thick][red] (2) -- (3);
\draw[ultra thick][red] (1) -- (3);
\draw[ultra thick][black] (1) -- (5);
\draw[ultra thick][black] (4) -- (3);
\draw[ultra thick][black] (5) -- (3);


    \end{tikzpicture}
    \caption{Graf G wraz z zaznaczoną strukturą $S$ oraz wierzchołkiem $v$}
 \end{figure}
 

 Zaaplikowanie własności 1 dla przedziału $P$ i pierwszego wierzchołka ze struktury czyli $\{1\}$ daje nam 
$$[\{5\},\{1,2,3,4,5\}] = [\{1,5\},\{1,2,3,4,5\}] \cup [\{5\},\{2,3,4,5\}]$$ 
Warto zauważyć, że drugi z wynikowych przedziałów nie łamie już ograniczenia narzuconego przez strukturę $P$, a więc można dodać go do listy przedziałów i kontynuować podział jedynie na pierwszym z przedziałów wynikowych. Analogiczna sytuacja zachodzi na każdym etapie podziału, ze względu na naturę ograniczenia wypływającego z kliki, gdzie usunięcie jednego z wierzchołków kliki powoduje akceptacje połączenia do reszty z nich. 

Kontynuujemy podział pozostałego przedziału dla kolejnego wierzchołka ze zbioru $\{2\}$
$$[\{1,5\},\{1,2,3,4,5\}] = [\{1,2,5\},\{1,2,3,4,5\}] \cup [\{1,5\},\{1,3,4,5\}]$$ 
Po raz kolejny można zaakceptować drugi z przedziałów i kontynuować podział pierwszego przez kolejny i ostatni wierzchołek $\{3\}$: 
$$[\{1,2,5\},\{1,2,3,4,5\}] = [\{1,2,3,5\},\{1,2,3,4,5\}] \cup [\{1,2,5\},\{1,2,4,5\}]$$
Po podziale przez ostatni z wierzchołków można, jak po każdym kroku zaakceptować drugi z wynikowych przedziałów. Pierwszy z nich natomiast zawiera w stożku ograniczającym dolnym strukturę. Dzięki temu można go odrzucić ze względu na to, że wszystkie stożki takiego przedziału powodują niedozwolone rozszerzenie grafu $\mathcal{F}$.

Podział przedziału dla zbioru niezależnego przeprowadzany jest w bardzo podobny sposób. Na każdym etapie podziału akceptowany jest pierwszy przedział wynikowy zamiast drugiego. W ramach przykładu podziału dla zbioru niezależnego załóżmy, że 
$P = [\emptyset,\{1,2\}]$ oraz $S = \{1,2,3,4\}$ i $S$ jest zbiorem niezależnym. Mamy również inny graf $G$.
\begin{figure}[H]
  \centering
   \begin{tikzpicture}[node distance={15mm}, main/.style = {draw, circle}] 
 \node[main][red] (1) at (1*90:1) {$1$};
 \node[main][red] (2) at (2*0:1.5) {$2$};
 \node[main] (5) at (3*60:1.5) {$5$};
 \node[main][red] (4) at (4*60:2) {$4$};
 \node[main][red] (3) at (5*60:2) {$3$};
 \node[main] (v) at (6*180:5) {$v$};

\draw[ultra thick][black] (2) -- (5);
\draw[ultra thick][black] (1) -- (5);
\draw[ultra thick][black] (5) -- (3);

    \end{tikzpicture}
    \caption{Graf $G$ wraz z zaznaczonymi wierzchołkami należącymi do struktury $S$ oraz wierzchołkiem $v$}
 \end{figure}
 

W takim wypadku zbiór wierzchołków, wzdłuż którego dokonujemy podziału nie obejmuje wszystkich wierzchołków należących do $S$. Jest tak dlatego, że część z nich należy już do $T_P$ i nie ma potrzeby ani możliwości dzielić przedziału przy ich pomocy. Dla pomniejszego zbioru wierzchołków {1,2} pierwszym etapem podziału będzie 
$$[{\emptyset},\{1,2\}]= [\{1\},\{1,2\}] \cup [{\emptyset},\{2\}]$$ Akceptujemy pierwszy przedział i przechodzimy do kolejnego kroku
$$ [{\emptyset},\{2\}]= [\{2\},\{2\}] \cup [{\emptyset},{\emptyset}]$$ Po przejściu wszystkich wierzchołków i zaakceptowaniu pierwszego przedziału można odrzucić drugi, ponieważ wszystkie stożki przez niego objęte łamią ograniczenie narzucone przez $S$.

Warto zauważyć, że w przypadku podziału przedziałów w taki sposób mamy gwarancje, że jeżeli przedział $P$ spełnia ograniczenie, to wszystkie jego podprzedziały również je spełniają. Ze względu na to, po zaaplikowaniu wszystkich ograniczeń, pozostałe przedziały posiadają poprawne rozszerzenia grafu F o wierzchołek tak, że nie jest zaburzona jego ramseyowskość. 
